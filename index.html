<!DOCTYPE html>
<html lang="en">
<head>
  <title>Bootstrap 5 Chat Example</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <style>
      body { font-family: Arial, Helvetica, sans-serif; }
      * { box-sizing: border-box; }

      .open-button {
          background-color: #555;
          color: white;
          padding: 16px 20px;
          border: none;
          cursor: pointer;
          opacity: 0.8;
          position: fixed;
          bottom: 20px;
          right: 20px;
          width: 280px;
      }

      .chat-popup {
          display: none;
          position: fixed;
          bottom: 0;
          right: 15px;
          border: 3px solid #f1f1f1;
          z-index: 9;
          width: 300px; /* Default width for larger screens */
      }

      .form-container {
          padding: 10px;
          background-color: white;
      }

      .form-container textarea {
          width: 100%;
          padding: 15px;
          margin: 5px 0 22px 0;
          border: none;
          background: #f1f1f1;
          resize: none;
          min-height: 100px;
      }

      .form-container textarea:focus {
          background-color: #ddd;
          outline: none;
      }

      .form-container .btn {
          background-color: #04AA6D;
          color: white;
          padding: 16px 20px;
          border: none;
          cursor: pointer;
          width: 100%;
          margin-bottom: 10px;
          opacity: 0.8;
      }

      .form-container .cancel {
          background-color: red;
      }

      .form-container .btn:hover, .open-button:hover {
          opacity: 1;
      }

      .chat-messages {
          border: 1px solid #f1f1f1;
          padding: 10px;
          height: 300px;
          overflow-y: auto;
          background-color: #f9f9f9;
          margin-bottom: 10px;
      }

      .chat-message {
          margin: 5px 0;
      }

      .chat-message span {
          font-weight: bold;
      }

      @media (max-width: 576px) {
          .chat-popup {
              width: 100%; /* Full width on small screens */
              bottom: 0; /* Adjust the position on small screens */
              right: 0;
          }
          .open-button {
              width: 100%; /* Full width button on small screens */
          }
      }
  </style>
</head>
<body>

    <h2 class="text-center mt-4">Chat With Faisal Mahmood</h2>

    <button class="open-button" onclick="openForm()">Chat</button>

    <div class="chat-popup" id="myForm">
        <div class="form-container">
            <h1>Chat</h1>

            <label for="username"><b>Enter your name</b></label>
            <input type="text" id="username" class="form-control" placeholder="Your name" required />

            <div class="chat-messages" id="chatMessages"></div>

            <label for="msg"><b>Message</b></label>
            <textarea placeholder="Type message.." id="msg" class="form-control" required></textarea>

            <button type="button" class="btn" onclick="sendMessage()">Send</button>
            <button type="button" class="btn cancel" onclick="closeForm()">Close</button>
        </div>
    </div>

    <script>
        // Initialize the chat messages from local storage
        window.onload = () => {
            displayStoredMessages();
        };

        // Open the chat window
        function openForm() {
            document.getElementById("myForm").style.display = "block";
        }

        // Close the chat window and clear chat messages
        function closeForm() {
            document.getElementById("myForm").style.display = "none";
        }

        // Send a message and store it in local storage
        function sendMessage() {
            const message = document.getElementById('msg').value;
            const username = document.getElementById('username').value || 'Anonymous';
            if (message.trim() !== '') {
                const chatMessage = { sender: username, message: message };
                storeMessage(chatMessage);
                displayMessage(username, message); // Show the sender's own message
                document.getElementById('msg').value = ''; // Clear textarea
            }
        }

        // Store message in local storage
        function storeMessage(chatMessage) {
            const messages = JSON.parse(localStorage.getItem('chatMessages')) || [];
            messages.push(chatMessage);
            localStorage.setItem('chatMessages', JSON.stringify(messages));
        }

        // Display stored messages from local storage
        function displayStoredMessages() {
            const messages = JSON.parse(localStorage.getItem('chatMessages')) || [];
            messages.forEach(msg => displayMessage(msg.sender, msg.message));
        }

        // Display a message in the chat window
        function displayMessage(sender, message) {
            const chatMessages = document.getElementById('chatMessages');
            const messageElement = document.createElement('div');
            messageElement.classList.add('chat-message');
            messageElement.innerHTML = `<span>${sender}:</span> ${message}`;
            chatMessages.appendChild(messageElement);
            chatMessages.scrollTop = chatMessages.scrollHeight; // Scroll to bottom
        }
    </script>

</body>
</html>
